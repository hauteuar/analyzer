flowchart TB
    %% User Layer
    U([User (Ops Team / FAs)]):::user

    %% Agent Layer
    subgraph AgentLayer["Opulence AI Agent"]
        QUEST[Context-Aware Quest Module]:::agent
        B{Check Cache?}:::decision
        CACHE[(Cache Store)]:::cache
        MEMORY[(Chat Session Memory)]:::memory
        EN[Enriched Query]:::process
        SEL{LLM / SLM Selector}:::decision
        SLM[Small Language Model]:::slm
        LLM[Large Language Model]:::llm
        ROUTE{Query Type?}:::decision
        RAG[Agentic RAG Retriever]:::process
        SUM[Summarizer]:::process
        RESP[Response Generator]:::process
    end

    %% Data Layer
    subgraph DataLayer["External Data Sources"]
        ORADB[(Oracle DB - Pricing Data)]:::database
        DOCKB[(Business Logic Document KB)]:::database
    end

    %% Flow Connections
    U --> QUEST
    QUEST --> B
    B -->|Yes| CACHE --> SUM
    B -->|No| MEMORY --> EN
    EN --> SEL
    SEL -->|Simple| SLM --> ROUTE
    SEL -->|Complex| LLM --> ROUTE

    ROUTE -->|Pricing Query| ORADB
    ROUTE -->|Business Logic Query| DOCKB
    ORADB --> RAG
    DOCKB --> RAG
    RAG --> SUM
    SUM --> RESP
    RESP --> U
    RESP --> CACHE

    %% Styles
    classDef user fill=#e3f2fd,stroke=#1565c0,stroke-width=2px,color=#0d47a1;
    classDef agent fill=#ede7f6,stroke=#512da8,stroke-width=2px,color=#311b92;
    classDef process fill=#f1f8e9,stroke=#33691e,stroke-width=1.5px,color=#1b5e20;
    classDef decision fill=#fff3e0,stroke=#ef6c00,stroke-width=2px,color=#e65100;
    classDef database fill=#e0f7fa,stroke=#00838f,stroke-width=2px,color=#006064;
    classDef memory fill=#fce4ec,stroke=#ad1457,stroke-width=2px,color=#880e4f;
    classDef cache fill=#eeeeee,stroke=#424242,stroke-width=2px,color=#212121;
    classDef llm fill=#ede7f6,stroke=#4527a0,stroke-width=2px,color=#311b92;
    classDef slm fill=#f9fbe7,stroke=#827717,stroke-width=2px,color=#33691e;